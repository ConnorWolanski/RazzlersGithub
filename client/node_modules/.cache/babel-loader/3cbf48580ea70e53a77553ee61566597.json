{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\Connor\\\\RazzlersGithub\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Connor\\\\RazzlersGithub\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Connor\\\\RazzlersGithub\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Connor\\\\RazzlersGithub\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Connor\\\\RazzlersGithub\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\Connor\\\\RazzlersGithub\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\Connor\\\\RazzlersGithub\\\\client\\\\src\\\\HTMLComponents\\\\Footer.js\";\nimport React from \"react\";\nimport '../style.css';\nimport envelope from '../images/envelope.png';\nimport Friends from '../images/friends.png';\nimport talk from '../images/talk.png';\nimport close from '../images/close.png';\nimport addfriend from '../images/add-friend.png';\nimport FriendsList from './FriendsList.js';\nimport MessageList from './MessageList.js';\nimport UnreadMessagesList from './UnreadMessagesList.js';\n\nvar utilFunc = require('../Helpers/UtilityFunctions');\n\nvar thisref = null;\n\nvar Footer =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Footer, _React$Component);\n\n  function Footer(props) {\n    var _this;\n\n    _classCallCheck(this, Footer);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Footer).call(this, props));\n    _this.state = {\n      friends: null,\n      IDs: null,\n      users: null,\n      ids: null,\n      defaultMessage: [],\n      unreadMessages: [],\n      unreadList: []\n    };\n    var username = window.localStorage.getItem(\"Razzlers_Username\");\n\n    if (username !== null) {\n      utilFunc.getUsersFriends(username).then(function (friendsList) {\n        _this.setState({\n          friends: friendsList.friends,\n          IDs: friendsList.IDs,\n          users: friendsList.friends,\n          ids: friendsList.IDs\n        });\n      });\n      utilFunc.getUnreadUsersMessages(username).then(function (messages) {\n        getUnreadList(messages.messages).then(function (list) {\n          _this.setState({\n            unreadMessages: messages.messages,\n            unreadList: list\n          });\n        });\n      });\n    }\n\n    thisref = _assertThisInitialized(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Footer, [{\n    key: \"handler\",\n    value: function handler() {\n      var _this2 = this;\n\n      utilFunc.getUsersFriends(window.localStorage.getItem(\"Razzlers_Username\")).then(function (friendsList) {\n        _this2.setState({\n          friends: friendsList.friends,\n          IDs: friendsList.IDs,\n          users: friendsList.friends,\n          ids: friendsList.IDs\n        });\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      setTimeout(function () {\n        updateUnreadMessages();\n\n        if (document.getElementById(\"messageTitle\") !== null && window.localStorage.getItem(\"Razzlers_Username\") !== null) {\n          updateMessages();\n        }\n      }, 1000);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state = this.state,\n          friends = _this$state.friends,\n          IDs = _this$state.IDs,\n          users = _this$state.users,\n          ids = _this$state.ids,\n          unreadMessages = _this$state.unreadMessages,\n          unreadList = _this$state.unreadList;\n      var unread;\n\n      if (unreadMessages.length > 9) {\n        unread = \"9+\";\n      } else {\n        unread = unreadMessages.length;\n      }\n\n      if (Array.isArray(friends)) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 64\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"footerMenu\",\n          hidden: true,\n          id: \"messages\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 65\n          },\n          __self: this\n        }, React.createElement(\"h1\", {\n          className: \"menuTitle\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 66\n          },\n          __self: this\n        }, React.createElement(\"font\", {\n          color: \"white\",\n          id: \"messageTitle\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 67\n          },\n          __self: this\n        }, window.localStorage.getItem(\"Razzlers_Username\")), React.createElement(\"font\", {\n          color: \"white\",\n          hidden: false,\n          id: \"unread\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 68\n          },\n          __self: this\n        }, \" Messages\"), React.createElement(\"button\", {\n          className: \"iconButton\",\n          onClick: function onClick() {\n            document.getElementById(\"messages\").hidden = true;\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 69\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          src: close,\n          alt: \"close\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 72\n          },\n          __self: this\n        }))), React.createElement(\"div\", {\n          className: \"autoFlow\",\n          id: \"messageBox\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 75\n          },\n          __self: this\n        }, React.createElement(MessageList, {\n          id: \"textMessages\",\n          messageList: this.state.defaultMessage,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 76\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          id: \"bottom\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 77\n          },\n          __self: this\n        })), React.createElement(\"form\", {\n          className: \"typeMessage\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 79\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          type: \"text\",\n          id: \"messageTyped\",\n          className: \"messageText\",\n          placeholder: \"text message\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 80\n          },\n          __self: this\n        }), React.createElement(\"button\", {\n          type: \"submit\",\n          className: \"sendButton\",\n          onClick: function onClick() {\n            window.event.preventDefault();\n            utilFunc.checkSpecialChars(document.getElementById(\"messageTyped\").value).then(function (str) {\n              sendMessage(document.getElementById(\"messageTitle\").innerHTML, str).then(function (result) {\n                utilFunc.getUsersMessages(window.localStorage.getItem(\"Razzlers_Username\"), document.getElementById(\"messageTitle\").innerHTML).then(function (json) {\n                  forceUpdateMessages();\n                  document.getElementById('messageTyped').value = \"\";\n                  setTimeout(function () {\n                    document.getElementById('bottom').scrollIntoView({\n                      behavior: \"smooth\"\n                    });\n                  }, 150);\n                });\n              });\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 81\n          },\n          __self: this\n        }, \"Send\"))), React.createElement(\"div\", {\n          className: \"footerMenu\",\n          hidden: true,\n          id: \"unreadMessages\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 98\n          },\n          __self: this\n        }, React.createElement(\"h1\", {\n          className: \"menuTitle\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 99\n          },\n          __self: this\n        }, React.createElement(\"font\", {\n          color: \"white\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 100\n          },\n          __self: this\n        }, \"Unread Messages\"), React.createElement(\"button\", {\n          className: \"iconButton\",\n          onClick: function onClick() {\n            return document.getElementById(\"unreadMessages\").hidden = true;\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 101\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          src: close,\n          alt: \"close\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 102\n          },\n          __self: this\n        }))), React.createElement(UnreadMessagesList, {\n          unreadList: unreadList,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 105\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          className: \"footerMenu\",\n          hidden: true,\n          id: \"friends\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 108\n          },\n          __self: this\n        }, React.createElement(\"h1\", {\n          className: \"menuTitle\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 109\n          },\n          __self: this\n        }, React.createElement(\"font\", {\n          color: \"white\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 110\n          },\n          __self: this\n        }, \"Friends\"), React.createElement(\"button\", {\n          className: \"iconButton\",\n          onClick: function onClick() {\n            return document.getElementById(\"friends\").hidden = true;\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 111\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          src: close,\n          alt: \"close\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112\n          },\n          __self: this\n        })), React.createElement(\"button\", {\n          className: \"iconButton\",\n          onClick: function onClick() {\n            document.getElementById(\"friends\").hidden = true;\n            document.getElementById(\"addFriends\").hidden = false;\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          src: addfriend,\n          alt: \"add friends\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 118\n          },\n          __self: this\n        }))), React.createElement(\"div\", {\n          className: \"autoFlow\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 121\n          },\n          __self: this\n        }, React.createElement(FriendsList, {\n          friends: friends,\n          IDs: IDs,\n          parent: this,\n          handler: this.handler.bind(this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 122\n          },\n          __self: this\n        }))), React.createElement(\"div\", {\n          className: \"footerMenu\",\n          hidden: true,\n          id: \"addFriends\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        }, React.createElement(\"h1\", {\n          className: \"menuTitle\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127\n          },\n          __self: this\n        }, React.createElement(\"font\", {\n          color: \"white\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128\n          },\n          __self: this\n        }, \"Add Friends\"), React.createElement(\"button\", {\n          className: \"iconButton\",\n          onClick: function onClick() {\n            var username = window.localStorage.getItem(\"Razzlers_Username\");\n\n            if (username !== null) {\n              utilFunc.getUsersFriends(username).then(function (friendsList) {\n                _this3.setState({\n                  friends: friendsList.friends,\n                  IDs: friendsList.IDs,\n                  users: friendsList.friends,\n                  ids: friendsList.IDs\n                });\n              });\n            }\n\n            document.getElementById(\"addFriends\").hidden = true;\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          src: close,\n          alt: \"close\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139\n          },\n          __self: this\n        }))), React.createElement(\"input\", {\n          type: \"text\",\n          className: \"userSearch\",\n          placeholder: \"Search Users\",\n          id: \"search1\",\n          onChange: function onChange() {\n            return searchUsers(document.getElementById(\"search1\").value).then(function (userlist) {\n              users = userlist.users.users;\n              ids = userlist.users.IDs;\n\n              _this3.setState({\n                users: users,\n                ids: ids\n              });\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          id: \"dhold\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 148\n          },\n          __self: this\n        }, React.createElement(FriendsList, {\n          friends: users,\n          IDs: ids,\n          handler: this.handler.bind(this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149\n          },\n          __self: this\n        }))), React.createElement(\"div\", {\n          className: \"footer\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          className: \"iconButton\",\n          onClick: function onClick() {\n            var username = window.localStorage.getItem(\"Razzlers_Username\");\n\n            if (username !== null) {\n              forceUpdateMessages();\n            }\n\n            document.getElementById(\"friends\").hidden = !document.getElementById(\"friends\").hidden;\n            document.getElementById(\"messages\").hidden = true;\n            document.getElementById(\"addFriends\").hidden = true;\n            document.getElementById(\"unreadMessages\").hidden = true;\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          src: Friends,\n          alt: \"friends\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165\n          },\n          __self: this\n        })), React.createElement(\"button\", {\n          className: \"iconButton\",\n          hidden: unread === 0,\n          onClick: function onClick() {\n            document.getElementById(\"unreadMessages\").hidden = !document.getElementById(\"unreadMessages\").hidden;\n            document.getElementById(\"friends\").hidden = true;\n            document.getElementById(\"messages\").hidden = true;\n            document.getElementById(\"addFriends\").hidden = true;\n            document.getElementById('bottom').scrollIntoView({\n              behavior: \"smooth\"\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 168\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          src: envelope,\n          alt: \"envelope\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 175\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          className: \"messageCount\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 176\n          },\n          __self: this\n        }, unread)), React.createElement(\"button\", {\n          className: \"iconButton\",\n          hidden: true,\n          id: \"messageSelected\",\n          onClick: function onClick() {\n            document.getElementById(\"messages\").hidden = !document.getElementById(\"messages\").hidden;\n            document.getElementById(\"friends\").hidden = true;\n            document.getElementById(\"addFriends\").hidden = true;\n            document.getElementById(\"unreadMessages\").hidden = true;\n            document.getElementById('bottom').scrollIntoView({\n              behavior: \"smooth\"\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 179\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          src: talk,\n          alt: \"talk\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 186\n          },\n          __self: this\n        }))));\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Footer;\n}(React.Component);\n\nfunction getUnreadList(unreadMessages) {\n  return new Promise(function (resolve, reject) {\n    var list = [];\n    var listOfUsers = [];\n\n    if (unreadMessages.length > 0) {\n      listOfUsers.push(unreadMessages[0].user_id);\n      list.push({\n        id: unreadMessages[0].user_id,\n        body: unreadMessages[0].message_body,\n        count: 1\n      });\n    }\n\n    for (var i = 1; i < unreadMessages.length; i++) {\n      if (listOfUsers.includes(unreadMessages[i].user_id)) {\n        for (var j = 0; j < list.length; j++) {\n          if (list[j].id === unreadMessages[i].user_id) {\n            list[j].count++;\n            j = list.length;\n          }\n        }\n      } else {\n        listOfUsers.push(unreadMessages[i].user_id);\n        list.push({\n          id: unreadMessages[i].user_id,\n          body: unreadMessages[i].message_body,\n          count: 1\n        });\n      }\n    }\n\n    resolve(list);\n  });\n}\n\nfunction updateUnreadMessages() {\n  if (window.localStorage.getItem(\"Razzlers_Username\") != null) {\n    setTimeout(function () {\n      utilFunc.getUnreadUsersMessages(window.localStorage.getItem(\"Razzlers_Username\")).then(function (messages) {\n        getUnreadList(messages.messages).then(function (list) {\n          thisref.setState({\n            unreadMessages: messages.messages,\n            unreadList: list\n          });\n        });\n      });\n      updateUnreadMessages();\n    }, 1000);\n  }\n}\n\nfunction updateMessages() {\n  forceUpdateMessages();\n  setTimeout(function () {\n    updateMessages();\n  }, 100);\n}\n\nfunction forceUpdateMessages() {\n  var sender = window.localStorage.getItem(\"Razzlers_Username\");\n  var recip = document.getElementById(\"messageTitle\").innerHTML;\n\n  if (sender !== recip) {\n    utilFunc.getUsersMessages(sender, recip).then(function (messages) {\n      thisref.setState({\n        defaultMessage: messages.messages\n      });\n    });\n\n    if (thisref.state.unreadMessages.length !== 0 && sender !== null && recip !== null && document.getElementById(\"messages\").hidden === false) {\n      utilFunc.readUserMessages(recip, sender);\n    }\n  }\n}\n\nfunction sendMessage(recipient, messageText) {\n  return new Promise(function (resolve, reject) {\n    var data = '{\"sender\": \"' + window.localStorage.getItem(\"Razzlers_Username\") + '\", \"recipient\": \"' + recipient + '\", \"message\": \"' + messageText + '\"}';\n    data = JSON.parse(data);\n    var transport = {\n      headers: {\n        'Content-Type': \"application/json\"\n      },\n      method: \"PUT\",\n      body: JSON.stringify(data)\n    };\n    var url = \"http://razzlers.me:3001/api/sendMessage\";\n    fetch(url, transport).then(function (result) {\n      return result.json();\n    }).then(function (json) {\n      resolve(json);\n    }).catch(function (err) {\n      throw new Error(err);\n    });\n  });\n}\n\nfunction getUserList() {\n  return new Promise(function (resolve, reject) {\n    var transport = {\n      headers: {\n        'Content-Type': \"application/json\"\n      },\n      method: \"GET\"\n    };\n    var url = \"http://razzlers.me:3001/api/getData/getUserList\";\n    fetch(url, transport).then(function (result) {\n      return result.json();\n    }).then(function (json) {\n      resolve(json);\n    }).catch(function (err) {\n      throw new Error(err);\n    });\n  });\n}\n\nfunction searchUsers(search) {\n  return new Promise(function (resolve, reject) {\n    getUserList().then(function (users) {\n      var s = search.toLowerCase();\n\n      for (var i = users.users.length - 1; i >= 0; i--) {\n        if (!users.users[i].toLowerCase().includes(s)) {\n          users.users.splice(i, 1);\n          users.IDs.splice(i, 1);\n        }\n      }\n\n      resolve({\n        users: users\n      });\n    });\n  });\n}\n\nexport default Footer;","map":{"version":3,"sources":["C:\\Users\\Connor\\RazzlersGithub\\client\\src\\HTMLComponents\\Footer.js"],"names":["React","envelope","Friends","talk","close","addfriend","FriendsList","MessageList","UnreadMessagesList","utilFunc","require","thisref","Footer","props","state","friends","IDs","users","ids","defaultMessage","unreadMessages","unreadList","username","window","localStorage","getItem","getUsersFriends","then","friendsList","setState","getUnreadUsersMessages","messages","getUnreadList","list","setTimeout","updateUnreadMessages","document","getElementById","updateMessages","unread","length","Array","isArray","hidden","event","preventDefault","checkSpecialChars","value","str","sendMessage","innerHTML","result","getUsersMessages","json","forceUpdateMessages","scrollIntoView","behavior","handler","bind","searchUsers","userlist","Component","Promise","resolve","reject","listOfUsers","push","user_id","id","body","message_body","count","i","includes","j","sender","recip","readUserMessages","recipient","messageText","data","JSON","parse","transport","headers","method","stringify","url","fetch","catch","err","Error","getUserList","search","s","toLowerCase","splice"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport '../style.css';\r\nimport envelope from '../images/envelope.png';\r\nimport Friends from '../images/friends.png';\r\nimport talk from '../images/talk.png';\r\nimport close from '../images/close.png';\r\nimport addfriend from '../images/add-friend.png';\r\nimport FriendsList from './FriendsList.js';\r\nimport MessageList from './MessageList.js';\r\nimport UnreadMessagesList from './UnreadMessagesList.js';\r\nconst utilFunc = require('../Helpers/UtilityFunctions');\r\n\r\nvar thisref = null;\r\nclass Footer extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      friends: null,\r\n      IDs: null,\r\n      users: null,\r\n      ids: null,\r\n      defaultMessage: [],\r\n      unreadMessages: [],\r\n      unreadList: []\r\n    };\r\n    var username = window.localStorage.getItem(\"Razzlers_Username\");\r\n    if (username !== null) {\r\n      utilFunc.getUsersFriends(username).then(friendsList => {\r\n        this.setState({friends: friendsList.friends, IDs: friendsList.IDs, users: friendsList.friends, ids: friendsList.IDs});\r\n      });\r\n      utilFunc.getUnreadUsersMessages(username).then(messages => {\r\n        getUnreadList(messages.messages).then(list => {\r\n          this.setState({unreadMessages: messages.messages, unreadList: list})\r\n        })\r\n      })\r\n    }\r\n    thisref = this;\r\n  }\r\n  handler() {\r\n    utilFunc.getUsersFriends(window.localStorage.getItem(\"Razzlers_Username\")).then(friendsList => {\r\n      this.setState({friends: friendsList.friends, IDs: friendsList.IDs, users: friendsList.friends, ids: friendsList.IDs});\r\n    });\r\n  }\r\n  componentDidMount()\r\n  {\r\n    setTimeout(function()\r\n    {\r\n      updateUnreadMessages();\r\n      if(document.getElementById(\"messageTitle\") !== null && window.localStorage.getItem(\"Razzlers_Username\") !== null)\r\n      {\r\n        updateMessages();\r\n      }\r\n    }, 1000);\r\n  }\r\n  render() {\r\n    var {friends, IDs, users, ids, unreadMessages, unreadList} = this.state;\r\n    var unread;\r\n    if(unreadMessages.length>9){\r\n      unread = \"9+\";\r\n    }else{\r\n      unread = unreadMessages.length ;\r\n    }\r\n    if (Array.isArray(friends)) {\r\n      return (<div>\r\n        <div className=\"footerMenu\" hidden={true} id=\"messages\">\r\n          <h1 className=\"menuTitle\">\r\n            <font color=\"white\" id =\"messageTitle\">{window.localStorage.getItem(\"Razzlers_Username\")}</font>\r\n            <font color=\"white\" hidden = {false} id= \"unread\"> Messages</font>\r\n            <button className=\"iconButton\" onClick={() => {\r\n                document.getElementById(\"messages\").hidden = true;\r\n              }}>\r\n              <img src={close} alt=\"close\"/>\r\n            </button>\r\n          </h1>\r\n          <div className=\"autoFlow\" id=\"messageBox\" >\r\n            <MessageList id=\"textMessages\" messageList={this.state.defaultMessage}></MessageList>\r\n            <div id= \"bottom\" ></div>\r\n          </div>\r\n          <form className=\"typeMessage\" >\r\n            <input type=\"text\" id=\"messageTyped\" className=\"messageText\" placeholder=\"text message\" />\r\n            <button type=\"submit\" className=\"sendButton\" onClick={() => {\r\n                window.event.preventDefault();\r\n                utilFunc.checkSpecialChars(document.getElementById(\"messageTyped\").value).then(str => {sendMessage(document.getElementById(\"messageTitle\").innerHTML, str).then(result => {\r\n                  utilFunc.getUsersMessages(window.localStorage.getItem(\"Razzlers_Username\"), document.getElementById(\"messageTitle\").innerHTML).then(json => {\r\n                    forceUpdateMessages();\r\n                    document.getElementById('messageTyped').value = \"\";\r\n                    setTimeout(function()\r\n                    {\r\n                      document.getElementById('bottom').scrollIntoView({behavior: \"smooth\"});\r\n                    }, 150);\r\n                  });\r\n                });\r\n              });\r\n              }}>Send</button>\r\n          </form>\r\n        </div>\r\n\r\n        <div className=\"footerMenu\" hidden={true} id=\"unreadMessages\">\r\n          <h1 className=\"menuTitle\">\r\n            <font color=\"white\">Unread Messages</font>\r\n            <button className=\"iconButton\" onClick={() => document.getElementById(\"unreadMessages\").hidden = true}>\r\n              <img src={close} alt=\"close\"/>\r\n            </button>\r\n          </h1>\r\n          <UnreadMessagesList unreadList = {unreadList}></UnreadMessagesList>\r\n        </div>\r\n\r\n        <div className=\"footerMenu\" hidden={true} id=\"friends\">\r\n          <h1 className=\"menuTitle\">\r\n            <font color=\"white\">Friends</font>\r\n            <button className=\"iconButton\" onClick={() => document.getElementById(\"friends\").hidden = true}>\r\n              <img src={close} alt=\"close\"/>\r\n            </button>\r\n            <button className=\"iconButton\" onClick={() => {\r\n                document.getElementById(\"friends\").hidden = true;\r\n                document.getElementById(\"addFriends\").hidden = false;\r\n              }}>\r\n              <img src={addfriend} alt=\"add friends\"/>\r\n            </button>\r\n          </h1>\r\n          <div className=\"autoFlow\">\r\n            <FriendsList friends={friends} IDs={IDs} parent={this} handler = {this.handler.bind(this)}/>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"footerMenu\" hidden={true} id=\"addFriends\">\r\n          <h1 className=\"menuTitle\">\r\n            <font color=\"white\">Add Friends</font>\r\n            <button className=\"iconButton\" onClick={() =>\r\n              {\r\n                var username = window.localStorage.getItem(\"Razzlers_Username\");\r\n                if (username !== null) {\r\n                  utilFunc.getUsersFriends(username).then(friendsList => {\r\n                    this.setState({friends: friendsList.friends, IDs: friendsList.IDs, users: friendsList.friends, ids: friendsList.IDs});\r\n                  });\r\n                }\r\n                document.getElementById(\"addFriends\").hidden = true;\r\n              }}>\r\n              <img src={close} alt=\"close\"/>\r\n            </button>\r\n          </h1>\r\n          <input type=\"text\" className=\"userSearch\" placeholder=\"Search Users\" id=\"search1\" onChange={()=>\r\n              searchUsers(document.getElementById(\"search1\").value).then(userlist => {\r\n                users = userlist.users.users;\r\n                ids = userlist.users.IDs;\r\n                this.setState({users:users, ids: ids});\r\n              })}/>\r\n            <div id=\"dhold\">\r\n              <FriendsList friends={users} IDs={ids} handler = {this.handler.bind(this)}/>\r\n            </div>\r\n        </div>\r\n\r\n        <div className=\"footer\">\r\n          <button className=\"iconButton\" onClick={() =>\r\n              {\r\n                var username = window.localStorage.getItem(\"Razzlers_Username\");\r\n                if (username !== null) {\r\n                  forceUpdateMessages();\r\n                }\r\n                document.getElementById(\"friends\").hidden = !document.getElementById(\"friends\").hidden;\r\n                document.getElementById(\"messages\").hidden = true;\r\n                document.getElementById(\"addFriends\").hidden = true;\r\n                document.getElementById(\"unreadMessages\").hidden = true;\r\n            }}>\r\n            <img src={Friends} alt=\"friends\"/>\r\n          </button>\r\n\r\n          <button className=\"iconButton\" hidden = {unread===0} onClick={() => {\r\n              document.getElementById(\"unreadMessages\").hidden = !document.getElementById(\"unreadMessages\").hidden;\r\n              document.getElementById(\"friends\").hidden = true;\r\n              document.getElementById(\"messages\").hidden = true;\r\n              document.getElementById(\"addFriends\").hidden = true;\r\n              document.getElementById('bottom').scrollIntoView({behavior: \"smooth\"});\r\n            }}>\r\n            <img src={envelope} alt=\"envelope\"/>\r\n            <div className = \"messageCount\">{unread}</div>\r\n          </button>\r\n\r\n          <button className=\"iconButton\" hidden = {true} id = \"messageSelected\" onClick={() => {\r\n              document.getElementById(\"messages\").hidden = !document.getElementById(\"messages\").hidden;\r\n              document.getElementById(\"friends\").hidden = true;\r\n              document.getElementById(\"addFriends\").hidden = true;\r\n              document.getElementById(\"unreadMessages\").hidden = true;\r\n              document.getElementById('bottom').scrollIntoView({behavior: \"smooth\"});\r\n            }}>\r\n            <img src={talk} alt=\"talk\"/>\r\n          </button>\r\n        </div>\r\n\r\n      </div>);\r\n    }\r\n    return (<div></div>)\r\n  }\r\n}\r\nfunction getUnreadList(unreadMessages){\r\n  return new Promise(function(resolve, reject){\r\n    var list = []\r\n    var listOfUsers = [];\r\n    if(unreadMessages.length >0){\r\n      listOfUsers.push(unreadMessages[0].user_id);\r\n      list.push({id: unreadMessages[0].user_id, body: unreadMessages[0].message_body, count: 1});\r\n    }\r\n    for(var i = 1; i < unreadMessages.length; i++){\r\n      if(listOfUsers.includes(unreadMessages[i].user_id)){\r\n        for(var j = 0; j < list.length; j++){\r\n          if(list[j].id === unreadMessages[i].user_id){\r\n            list[j].count++;\r\n            j = list.length;\r\n          }\r\n        }\r\n      }else{\r\n        listOfUsers.push(unreadMessages[i].user_id);\r\n        list.push({id: unreadMessages[i].user_id, body: unreadMessages[i].message_body, count: 1});\r\n      }\r\n    }\r\n    resolve(list);\r\n  })\r\n}\r\n\r\nfunction updateUnreadMessages(){\r\n\r\n  if(window.localStorage.getItem(\"Razzlers_Username\") != null){\r\n    setTimeout(function()\r\n    {\r\n        utilFunc.getUnreadUsersMessages(window.localStorage.getItem(\"Razzlers_Username\")).then(messages => {\r\n          getUnreadList(messages.messages).then(list => {\r\n            thisref.setState({unreadMessages: messages.messages, unreadList: list})\r\n          })\r\n        })\r\n      updateUnreadMessages();\r\n    }, 1000);\r\n  }\r\n}\r\n\r\nfunction updateMessages()\r\n{\r\n  forceUpdateMessages();\r\n  setTimeout(function()\r\n  {\r\n   updateMessages();\r\n }, 100);\r\n}\r\n\r\nfunction forceUpdateMessages()\r\n{\r\n  var sender = window.localStorage.getItem(\"Razzlers_Username\");\r\n  var recip = document.getElementById(\"messageTitle\").innerHTML;\r\n  if(sender !== recip)\r\n  {\r\n    utilFunc.getUsersMessages(sender, recip).then(messages => {\r\n      thisref.setState({defaultMessage: messages.messages});\r\n    });\r\n    if(thisref.state.unreadMessages.length !== 0 && sender !== null && recip !== null && document.getElementById(\"messages\").hidden === false){\r\n      utilFunc.readUserMessages(recip, sender);\r\n    }\r\n  }\r\n}\r\n\r\nfunction sendMessage(recipient, messageText)\r\n{\r\n  return new Promise(function(resolve, reject) {\r\n    var data = '{\"sender\": \"' + window.localStorage.getItem(\"Razzlers_Username\") + '\", \"recipient\": \"' + recipient + '\", \"message\": \"' + messageText + '\"}';\r\n    data = JSON.parse(data);\r\n    var transport = {\r\n      headers: {\r\n        'Content-Type': \"application/json\"\r\n      },\r\n      method: \"PUT\",\r\n      body: JSON.stringify(data)\r\n    };\r\n    const url = \"http://razzlers.me:3001/api/sendMessage\";\r\n    fetch(url, transport).then(result => result.json()).then(json => {\r\n      resolve(json);\r\n    }).catch(err => {\r\n      throw new Error(err);\r\n    });\r\n  });\r\n}\r\n\r\nfunction getUserList() {\r\n  return new Promise(function(resolve, reject) {\r\n    var transport = {\r\n      headers: {\r\n        'Content-Type': \"application/json\"\r\n      },\r\n      method: \"GET\"\r\n    };\r\n    const url = \"http://razzlers.me:3001/api/getData/getUserList\";\r\n    fetch(url, transport).then(result => result.json()).then(json => {\r\n      resolve(json);\r\n    }).catch(err => {\r\n      throw new Error(err);\r\n    });\r\n  });\r\n}\r\nfunction searchUsers(search) {\r\n  return new Promise(function(resolve, reject) {\r\n    getUserList().then(users => {\r\n    var s = search.toLowerCase();\r\n    for (var i = users.users.length - 1; i >= 0; i--) {\r\n      if (!users.users[i].toLowerCase().includes(s)) {\r\n        users.users.splice(i, 1);\r\n        users.IDs.splice(i, 1);\r\n      }\r\n    }\r\n    resolve({users});})\r\n  });\r\n}\r\n\r\nexport default Footer\r\n"]},"metadata":{},"sourceType":"module"}